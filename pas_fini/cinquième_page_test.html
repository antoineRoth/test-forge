<!--inspirÃ© par la version officielle de la page de tuto de AUTODESK FORGE-->
<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, height=device-height, minimal-ui, minimum-scale=1.0, initial-scale=1, user-scalable=no"/>
  <link rel="stylesheet" href="https://autodeskviewer.com/viewers/2.15/style.min.css" type="text/css"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Viewer</title>

  <style>

    body{
      margin:0
    }

    .viewer {
      position: absolute
      top: 10px
	  right: 10 px
    }

  </style>

</head>

<body>

  <script src="https://autodeskviewer.com/viewers/2.15/three.min.js"></script>
  <script src="https://autodeskviewer.com/viewers/2.15/viewer3D.min.js"></script>

  <div id="viewer" class="viewer"></div>
  <div id="highlight_color" class="change_color">
	<button id="red_but">Change to red</button>
	<button id="green_but">Change to green</button>
	<button id="blue_but">Change to blue</button>
  </div>

  <script>

    var token = 'eyJhbGciOiJIUzI1NiIsImtpZCI6Imp3dF9zeW1tZXRyaWNfa2V5In0.eyJzY29wZSI6WyJkYXRhOnJlYWQiLCJkYXRhOndyaXRlIiwiZGF0YTpjcmVhdGUiLCJidWNrZXQ6cmVhZCIsImJ1Y2tldDpjcmVhdGUiXSwiY2xpZW50X2lkIjoiVVVVNk9hbmFaUGJNdHgyS0VkUzFJQXVjS0d4RjVqTXkiLCJhdWQiOiJodHRwczovL2F1dG9kZXNrLmNvbS9hdWQvand0ZXhwNjAiLCJqdGkiOiJmRlo0bzBmUDJtdXVBVTk3YTJqZHhPSWs4WExHdXQyZ3kyY0ltQUxFdk12dVNQVThqZ2U0bjVUWGptaDJTUGg0IiwiZXhwIjoxNTkwNjcxNzY2fQ.5L6Tlxc8tk2wP5R5ZybO_kCRgYOUKFFKwnWyNsTeYuM';
	// replace URN with one generated
    // from corresponding credentials to the token above
    var urn = 'urn:dXJuOmFkc2sub2JqZWN0czpvcy5vYmplY3Q6dGVzdF9jb2xsYWJfdjQvUHJvamVjdDEuaWZj'

    /////////////////////////////////////////////////////////////////
    // Initialization Options
    //
    /////////////////////////////////////////////////////////////////
    var initOptions = {
      documentId: urn,
      env: 'AutodeskProduction',
      getAccessToken: function( onGetAccessToken) {
        return token
      }
    }

    // typically getAccessToken would look like below
    // where /api/forge/token is a REST endpoint
    // on your own server that return a valid forge token
    //
    //getAccessToken: function(onGetAccessToken) {
    //  $.get('/api/forge/token', function(token) {
    //    onGetAccessToken(token.access_token)
    //  })
    //}

    /////////////////////////////////////////////////////////////////
    // Document Loaded Handler
    //
    /////////////////////////////////////////////////////////////////
    function onDocumentLoaded (doc) {

      var rootItem = doc.getRootItem()

      // Grab all geometry items
      var geometryItems =
        Autodesk.Viewing.Document.getSubItemsWithProperties(
          rootItem, { 'type': 'geometry' }, true)

      // Pick the first item by default
      var selectedItem = geometryItems[0]

      var domContainer = document.getElementById('viewer')

      // UI-less Version: viewer without controls and commands
      //var viewer = new Autodesk.Viewing.Viewer3D(domContainer)

      // GUI Version: viewer with controls
      var viewer = new Autodesk.Viewing.Private.GuiViewer3D(domContainer)

      viewer.initialize()

      viewer.loadModel(doc.getViewablePath(selectedItem))
	  
	  viewer.impl.setSelectionColor(new THREE.Color(1,0,0));
	  viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT, ()=>viewer.select(1))
    }

    /////////////////////////////////////////////////////////////////
    // Environment Initialized Handler
    //
    /////////////////////////////////////////////////////////////////
    function onEnvInitialized () {

      Autodesk.Viewing.Document.load(
        initOptions.documentId,
        function(doc) {
          onDocumentLoaded (doc)
        },
        function (errCode){
          onLoadError (errCode)
        })
    }

    /////////////////////////////////////////////////////////////////
    // Error Handler
    //
    /////////////////////////////////////////////////////////////////
    function onLoadError (errCode) {

      console.log('Error loading document: ' + errCode)
    }

    /////////////////////////////////////////////////////////////////
    // Bootstraping
    //
    /////////////////////////////////////////////////////////////////
    Autodesk.Viewing.Initializer(
      initOptions,
      function() {
        onEnvInitialized ()
      }
	)

  </script>

</body>
</html>